import csv
import re

# File name
csv_file = "droplets.csv"

# Read CSV file
droplets = {}

with open(csv_file, mode="r", newline="") as file:
    reader = csv.DictReader(file)
    for row in reader:
        # Extract coordinates safely using regex
        match = re.search(r"\((\d+),\s*(\d+)\)", row["Coordinate"])
        if match:
            x, y = int(match.group(1)), int(match.group(2))
            droplet_num = int(row["Number"])
            droplets[droplet_num] = {
                "color": row["Color"],
                "coords": (x, y)
            }

# ✅ At this point, you have a dictionary like:
# {1: {'color': 'Red', 'coords': (154, 207)}, ...}

# Let the user pick a droplet
print("Available droplets:")
for num, info in droplets.items():
    print(f"{num}. {info['color']} at {info['coords']}")

while True:
    try:
        selected_num = int(input("\nEnter the droplet number to use: "))
        if selected_num in droplets:
            drop_px = droplets[selected_num]["coords"]
            print(f"\nSelected droplet #{selected_num} ({droplets[selected_num]['color']})")
            print(f"drop_px = {drop_px}")
            break
        else:
            print("Invalid number. Try again.")
    except ValueError:
        print("Please enter a valid integer.")
